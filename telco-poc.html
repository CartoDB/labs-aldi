<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Deep-Insights.js – Madrid: Airbnb, nightlife, and public transport</title>
  <meta name=viewport content="width=device-width initial-scale=1">
  <link href="http://cartodb.com/favicon.ico" rel="shortcut icon" />
  <link href="deep-insights.js/dist/themes/css/deep-insights.css" rel="stylesheet" />
  <script src="deep-insights.js/dist/deep-insights.uncompressed.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
  <style type="text/css">
    html,
    body {
      position: relative;
      height: 100%;
      padding: 0;
      margin: 0;
    }
  </style>
</head>

<body>
  <div class="Dashboard-canvas" id="dashboard"></div>

  <script>
  var widgetInfo = {};
  var globalLayers;
  var updateMap = function (widgetInfo) {
      console.log('updating map', widgetInfo, globalLayers);



  }
    window.onload = function() {
//       var diJSON = {  
//    "title":"Airbnb Madrid and closest metro lines",
//    "description":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vulputate consequat vehicula. Sed eget leo a ex tempus cursus. Etiam consectetur cursus tortor, id dapibus elit condimentum id. Nulla sed gravida lorem, at ornare lectus. Aliquam quis erat porttitor, varius lectus eget, rhoncus mi...",
//    "user":{  
//       "fullname":"Emilio García",
//       "avatar_url":"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/piensaenpixel/assets/20150507074635Captura%20de%20pantalla%202015-05-07%20a%20la%28s%29%2009.46.28.png"
//    },
//    "updated_at":"2015-10-26T11:50:30+00:00",
//    "datasource":{  
//       "type":"public_map",
//       "user_name":"solutions-ded02",
//       "maps_api_template":"https://{user}.cartodb-staging.com:443",
//       "stat_tag":"be7a4d14-c3a1-11e5-afb7-04013fc66a01",
//       "force_cors":true      // This is sometimes set in the editor
//    },
//    "widgets":[
//       {
//          "type":"histogram",
//          "layerIndex": 3,
//          "title":"Median Age",
//          "options": {
//            "column":"median_age",
//            "bins":10          
//          }

//       } 
//       // {
//       //   "histogram_widget_median_income":{  
//       //    "layerId":"e8fd9207-89c1-4be0-89e2-c06315a3ea07",
//       //    "type":"histogram",
//       //    "title":"Median Income",
//       //    "column":"median_income",
//       //    "bins":10
//       //   }
//       // },
//       // {
//       //   "histogram_widget_commercial_areas":{  
//       //      "layerId":"e8fd9207-89c1-4be0-89e2-c06315a3ea07",
//       //      "type":"histogram",
//       //      "title":"Commercial Area (% Inside Block)",
//       //      "column":"commercial_prop",
//       //      "bins":10
//       //   }
//       // },
//       // {
//       //   'formula_widget_price_avg': {
//       //     "layerId": "e8fd9207-89c1-4be0-89e2-c06315a3ea07",
//       //     "type": "formula",
//       //     "title": "Average of Median Incomes ",
//       //     "column": "median_income",
//       //     "prefix": "$",
//       //     "operation": "avg"
//       //   }
//       // } 
//    ]
// }; 




//       var vizJSONUrl = 'telco.viz.json';
//       //var vizJSONUrl = 'http://solutions-ded02.cartodb-staging.com/api/v2/viz/be7a4d14-c3a1-11e5-afb7-04013fc66a01/viz.json';






//         $.getJSON(vizJSONUrl, function(vizJSON) {
//           diJSON.vizJSON = vizJSON;



var vizJSON = { 
  "title":"Airbnb Madrid and closest metro lines",
   "description":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vulputate consequat vehicula. Sed eget leo a ex tempus cursus. Etiam consectetur cursus tortor, id dapibus elit condimentum id. Nulla sed gravida lorem, at ornare lectus. Aliquam quis erat porttitor, varius lectus eget, rhoncus mi...",
   "user":{  
      "fullname":"Emilio García",
      "avatar_url":"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/piensaenpixel/assets/20150507074635Captura%20de%20pantalla%202015-05-07%20a%20la%28s%29%2009.46.28.png"
   },
   "updated_at":"2015-10-26T11:50:30+00:00",

  "datasource":{  
      "type":"public_map",
      "user_name":"solutions-ded02",
      "maps_api_template":"https://{user}.cartodb-staging.com:443",
      "stat_tag":"be7a4d14-c3a1-11e5-afb7-04013fc66a01",
      "force_cors":true      // This is sometimes set in the editor
   },
   "widgets":[
      {
         "type":"histogram",
         "layerIndex": 1,
         "title":"Median Age",
         "options": {
           "column":"median_age",
           "bins":10          
         }
      },
      {
         "type":"histogram",
         "layerIndex": 1,
         "title":"Median Income",
         "options": {
           "column":"median_income",
           "bins":10          
         }
      }  
    ],

   "id":"be7a4d14-c3a1-11e5-afb7-04013fc66a01",
   "version":"0.1.0",
   "title":"telco",
   "likes":0,
   "description":null,
   "scrollwheel":false,
   "legends":true,
   "url":null,
   "map_provider":"leaflet",
   "bounds":[  
      [  
         40.69664826715396,
         -74.06450271606445
      ],
      [  
         40.77820166245534,
         -73.81027221679688
      ]
   ],
   "center":"[40.73743746199328, -73.93738746643066]",
   "zoom":10,
   "updated_at":"2016-01-26T21:19:41+00:00",
   "layers":[  
      {  
         "options":{  
            "visible":true,
            "type":"Tiled",
            "name":"Dark matter (labels below)",
            "className":"httpscartodbbasemapssglobalsslfastlynetdark_allzxypng",
            "base_type":"default",
            "urlTemplate":"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",
            "minZoom":"0",
            "maxZoom":"18",
            "attribution":"&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"http://cartodb.com/attributions\">CartoDB</a>",
            "subdomains":"abcd",
            "style":null,
            "read_only":true,
            "category":"CartoDB",
            "order":0,
            "id":"905988dd-ee73-4d21-bad3-c864c854bf34"
         },
         "infowindow":null,
         "tooltip":null,
         "id":"905988dd-ee73-4d21-bad3-c864c854bf34",
         "order":0,
         "type":"tiled"
      },
      {  
         "type":"layergroup",
         "options":{  
            "user_name":"solutions-ded02",
            "maps_api_template":"https://{user}.cartodb-staging.com:443",
            "sql_api_template":"https://{user}.cartodb-staging.com:443",
            "tiler_protocol":"http",
            "tiler_domain":"cartodb-staging.com",
            "tiler_port":"80",
            "sql_api_protocol":"http",
            "sql_api_domain":"cartodb-staging.com",
            "sql_api_endpoint":"/api/v2/sql",
            "sql_api_port":80,
            "filter":"mapnik",
            "layer_definition":{  
               "stat_tag":"be7a4d14-c3a1-11e5-afb7-04013fc66a01",
               "version":"1.0.1",
               "layers":[  
                  {  
                     "id":"e8fd9207-89c1-4be0-89e2-c06315a3ea07",
                     "type":"CartoDB",
                     "infowindow":{  
                        "fields":[  

                        ],
                        "template_name":"table/views/infowindow_light",
                        "template":"<div class=\"cartodb-popup v2\">\n  <a href=\"#close\" class=\"cartodb-popup-close-button close\">x</a>\n  <div class=\"cartodb-popup-content-wrapper\">\n    <div class=\"cartodb-popup-content\">\n      {{#content.fields}}\n        {{#title}}<h4>{{title}}</h4>{{/title}}\n        {{#value}}\n          <p {{#type}}class=\"{{ type }}\"{{/type}}>{{{ value }}}</p>\n        {{/value}}\n        {{^value}}\n          <p class=\"empty\">null</p>\n        {{/value}}\n      {{/content.fields}}\n    </div>\n  </div>\n  <div class=\"cartodb-popup-tip-container\"></div>\n</div>\n",
                        "alternative_names":{  

                        },
                        "width":226,
                        "maxHeight":180
                     },
                     "tooltip":{  
                        "fields":[  

                        ],
                        "template_name":"tooltip_light",
                        "template":"<div class=\"cartodb-tooltip-content-wrapper\">\n  <div class=\"cartodb-tooltip-content\">\n  {{#fields}}\n    {{#title}}\n    <h4>{{title}}</h4>\n    {{/title}}\n    <p>{{{ value }}}</p>\n  {{/fields}}\n  </div>\n</div>",
                        "alternative_names":{  

                        },
                        "maxHeight":180
                     },
                     "legend":{  
                        "type":"choropleth",
                        "show_title":false,
                        "title":"",
                        "template":"",
                        "visible":true,
                        "items":[  
                           {  
                              "name":"Left label",
                              "visible":true,
                              "value":"30011.50",
                              "type":"text"
                           },
                           {  
                              "name":"Right label",
                              "visible":true,
                              "value":"232266.00",
                              "type":"text"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#EDF8FB",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#D7FAF4",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#CCECE6",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#66C2A4",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#41AE76",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#238B45",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#005824",
                              "type":"color"
                           }
                        ]
                     },
                     "order":1,
                     "visible":true,
                     "options":{  
                        "sql":"SELECT * FROM nyct_income_age_comm",
                        "layer_name":"nyct_income_age",
                        "cartocss":"/** choropleth visualization */\n\n#nyct_income_age{\n  polygon-fill: #EDF8FB;\n  polygon-opacity: 0.5;\n  line-color: #FFF;\n  line-width: 0;\n  line-opacity: 1;\n}\n#nyct_income_age [ median_income <= 232266] {\n   polygon-fill: #005824;\n}\n#nyct_income_age [ median_income <= 86618.5] {\n   polygon-fill: #238B45;\n}\n#nyct_income_age [ median_income <= 69956.5] {\n   polygon-fill: #41AE76;\n}\n#nyct_income_age [ median_income <= 58371] {\n   polygon-fill: #66C2A4;\n}\n#nyct_income_age [ median_income <= 49055.5] {\n   polygon-fill: #CCECE6;\n}\n#nyct_income_age [ median_income <= 40193.5] {\n   polygon-fill: #D7FAF4;\n}\n#nyct_income_age [ median_income <= 30011.5] {\n   polygon-fill: #EDF8FB;\n}",
                        "cartocss_version":"2.1.1",
                        "interactivity":"cartodb_id",
                        "table_name":"\"\"."
                     }
                  },
                  {  
                     "id":"4dca16c0-b1d9-4886-b0ec-0cf07dcddaae",
                     "type":"CartoDB",
                     "infowindow":{  
                        "fields":[  

                        ],
                        "template_name":"table/views/infowindow_light",
                        "template":"<div class=\"cartodb-popup v2\">\n  <a href=\"#close\" class=\"cartodb-popup-close-button close\">x</a>\n  <div class=\"cartodb-popup-content-wrapper\">\n    <div class=\"cartodb-popup-content\">\n      {{#content.fields}}\n        {{#title}}<h4>{{title}}</h4>{{/title}}\n        {{#value}}\n          <p {{#type}}class=\"{{ type }}\"{{/type}}>{{{ value }}}</p>\n        {{/value}}\n        {{^value}}\n          <p class=\"empty\">null</p>\n        {{/value}}\n      {{/content.fields}}\n    </div>\n  </div>\n  <div class=\"cartodb-popup-tip-container\"></div>\n</div>\n",
                        "alternative_names":{  

                        },
                        "width":226,
                        "maxHeight":180
                     },
                     "tooltip":{  
                        "fields":[  

                        ],
                        "template_name":"tooltip_light",
                        "template":"<div class=\"cartodb-tooltip-content-wrapper\">\n  <div class=\"cartodb-tooltip-content\">\n  {{#fields}}\n    {{#title}}\n    <h4>{{title}}</h4>\n    {{/title}}\n    <p>{{{ value }}}</p>\n  {{/fields}}\n  </div>\n</div>",
                        "alternative_names":{  

                        },
                        "maxHeight":180
                     },
                     "legend":{  
                        "type":"none",
                        "show_title":false,
                        "title":"",
                        "template":"",
                        "visible":true,
                        "items":[  
                           {  
                              "name":"Left label",
                              "visible":true,
                              "value":"0.00",
                              "type":"text"
                           },
                           {  
                              "name":"Right label",
                              "visible":true,
                              "value":"0.00",
                              "type":"text"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#FFFFB2",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#FED976",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#FEB24C",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#FD8D3C",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#FC4E2A",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#E31A1C",
                              "type":"color"
                           },
                           {  
                              "name":"Color",
                              "visible":true,
                              "value":"#B10026",
                              "type":"color"
                           }
                        ]
                     },
                     "order":2,
                     "visible":true,
                     "options":{  
                        "sql":"select * from nyc_commercial_areas",
                        "layer_name":"nyc_commercial_areas",
                        "cartocss":"/** simple visualization */\n\n#nyc_commercial_areas{\n  polygon-fill: #2E5387;\n  polygon-opacity: 0.9;\n  line-color: #FFF;\n  line-width: 0;\n  line-opacity: 1;\n}",
                        "cartocss_version":"2.1.1",
                        "interactivity":"cartodb_id",
                        "table_name":"\"\"."
                     }
                  },
                  {  
                     "id":"88daa888-5409-468e-9a89-e2fa2ab69382",
                     "type":"CartoDB",
                     "infowindow":{  
                        "fields":[  

                        ],
                        "template_name":"table/views/infowindow_light",
                        "template":"<div class=\"cartodb-popup v2\">\n  <a href=\"#close\" class=\"cartodb-popup-close-button close\">x</a>\n  <div class=\"cartodb-popup-content-wrapper\">\n    <div class=\"cartodb-popup-content\">\n      {{#content.fields}}\n        {{#title}}<h4>{{title}}</h4>{{/title}}\n        {{#value}}\n          <p {{#type}}class=\"{{ type }}\"{{/type}}>{{{ value }}}</p>\n        {{/value}}\n        {{^value}}\n          <p class=\"empty\">null</p>\n        {{/value}}\n      {{/content.fields}}\n    </div>\n  </div>\n  <div class=\"cartodb-popup-tip-container\"></div>\n</div>\n",
                        "alternative_names":{  

                        },
                        "width":226,
                        "maxHeight":180
                     },
                     "tooltip":{  
                        "fields":[  

                        ],
                        "template_name":"tooltip_light",
                        "template":"<div class=\"cartodb-tooltip-content-wrapper\">\n  <div class=\"cartodb-tooltip-content\">\n  {{#fields}}\n    {{#title}}\n    <h4>{{title}}</h4>\n    {{/title}}\n    <p>{{{ value }}}</p>\n  {{/fields}}\n  </div>\n</div>",
                        "alternative_names":{  

                        },
                        "maxHeight":180
                     },
                     "legend":{  
                        "type":"none",
                        "show_title":false,
                        "title":"",
                        "template":"",
                        "visible":true
                     },
                     "order":3,
                     "visible":true,
                     "options":{  
                        "sql":"select * from store_locations",
                        "layer_name":"store_locations",
                        "cartocss":"/** simple visualization */\n\n#store_locations{\n  marker-fill-opacity: 0.9;\n  marker-line-color: #d8ff00;\n  marker-line-width: 2;\n  marker-line-opacity: 1;\n  marker-placement: point;\n  marker-type: ellipse;\n  marker-width: 6;\n  marker-fill: #A53ED5;\n  marker-allow-overlap: true;\n}",
                        "cartocss_version":"2.1.1",
                        "interactivity":"cartodb_id",
                        "table_name":"\"\"."
                     }
                  }
               ]
            },
            "attribution":""
         }
      }
   ],
   "overlays":[  
      {  
         "type":"share",
         "order":2,
         "options":{  
            "display":true,
            "x":20,
            "y":20
         },
         "template":""
      },
      {  
         "type":"search",
         "order":3,
         "options":{  
            "display":true,
            "x":60,
            "y":20
         },
         "template":""
      },
      {  
         "type":"zoom",
         "order":6,
         "options":{  
            "display":true,
            "x":20,
            "y":20
         },
         "template":"<a href=\"#zoom_in\" class=\"zoom_in\">+</a> <a href=\"#zoom_out\" class=\"zoom_out\">-</a>"
      },
      {  
         "type":"loader",
         "order":8,
         "options":{  
            "display":true,
            "x":20,
            "y":150
         },
         "template":"<div class=\"loader\" original-title=\"\"></div>"
      },
      {  
         "type":"logo",
         "order":9,
         "options":{  
            "display":true,
            "x":10,
            "y":40
         },
         "template":""
      }
   ],
   "prev":null,
   "next":null,
   "transition_options":{  
      "time":0
   }
}


    cartodb.deepInsights.createDashboard('#dashboard', vizJSON, {  
      no_cdn:false
    });
        
}
  </script>
</body>

</html>
